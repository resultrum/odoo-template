# .gitignore Reference Guide

Complete explanation of what's ignored and why.

---

## Overview

Our `.gitignore` is organized into sections, each with a specific purpose.

**Files kept in Git:**
- `addons/custom/` - Custom Metrum modules
- `addons/oca-addons/.gitkeep` - Marker for symlinks directory
- All source code files
- Documentation and configuration

**Files ignored (not in Git):**
- Generated/compiled files
- Environment secrets
- IDE settings
- Docker volumes/data
- Temporary files

---

## Section-by-Section Breakdown

### 1. Python

```
__pycache__/           # Python bytecode cache
*.py[cod]              # Compiled Python files
*.pyc                  # Python bytecode
*.egg-info/            # Package info
build/                 # Build artifacts
dist/                  # Distribution files
```

**Why ignore?** These are generated during Python execution, not source code.

---

### 2. Odoo

```
filestore/             # Odoo's file attachments storage
sessions/              # Session data
/addons/oca-addons/*   # Symlinks (generated)
!/addons/oca-addons/.gitkeep  # Keep marker only
```

**Why ignore?**
- `filestore/` & `sessions/` are generated runtime data
- Symlinks are auto-generated by `entrypoint.sh` and `scripts/`
- `.gitkeep` ensures directory stays in Git (empty dirs aren't tracked)

---

### 3. Docker Volumes & Data

```
odoo-data/             # Odoo persistent data
postgres-data/         # Database storage
odoo-web-data/         # Web data volume
/backups/              # Database backups
*.sql                  # SQL dump files
*.sql.gz               # Compressed SQL
*.dump                 # Database dumps
```

**Why ignore?**
- These are runtime data, not code
- Can be huge (GBs of data)
- Should be backed up separately, not in Git
- Each developer/environment has different data

---

### 4. Environment & Secrets

```
.env                   # Local environment variables
.env.local             # Local-only environment
.env.*.local           # Environment overrides
.env.production        # Production secrets
.ssh/                  # SSH keys
*.pem                  # Private keys
*.key                  # Key files
credentials.json       # Credentials
auth.json              # Auth tokens
```

**Why ignore (SECURITY!)?**
- Passwords must never be in Git
- API keys must never be committed
- SSH keys must be kept secret
- Each environment has different secrets
- Use `.env.example` as template instead

---

### 5. IDE & Editor

```
.vscode/               # VS Code settings
.idea/                 # PyCharm/IntelliJ settings
.iml                   # IDE project files
*.sublime-workspace    # Sublime editor files
.project               # Eclipse project
.pydevproject          # PyDev settings
.settings/             # IDE settings folder
```

**Why ignore?**
- IDE settings are personal preferences
- Different developers use different IDEs
- These shouldn't be enforced across the team

---

### 6. Claude Code

```
.claude/               # Claude Code configuration
.claude/**             # All Claude Code files
```

**Why ignore?**
- Claude Code settings are local/personal
- Not relevant for team collaboration
- Can vary per developer

---

### 7. Package Managers

```
node_modules/          # npm dependencies
npm-debug.log          # npm debug logs
yarn-error.log         # Yarn errors
pnpm-lock.yaml         # pnpm lock file
```

**Why ignore?**
- Dependencies are installed via `package.json` (if we used Node)
- Lock files can be huge
- Downloaded automatically, not source code

---

### 8. Operating System

```
.DS_Store              # macOS metadata
.DS_Store?             # macOS variant
._*                    # macOS hidden files
.Spotlight-V100        # macOS search index
Thumbs.db              # Windows thumbnails
ehthumbs.db            # Windows image cache
desktop.ini            # Windows settings
```

**Why ignore?**
- OS-specific, not relevant to project
- Different across macOS/Windows/Linux
- Clutter the repository

---

### 9. Temporary Files

```
*.tmp                  # Temporary files
*.bak                  # Backup files
*.swp                  # Vim swap files
*.swo                  # Vim swap alternative
*~                     # Editor backups
.~lock.*               # File locks
*.lnk                  # Windows shortcuts
```

**Why ignore?**
- Editor temporary files
- Backup copies
- Lock files from concurrent editing
- Not needed in repository

---

### 10. Logs

```
logs/                  # Log directory
*.log                  # Log files
npm-debug.log*         # npm logs
yarn-debug.log*        # Yarn logs
yarn-error.log*        # Yarn errors
```

**Why ignore?**
- Logs are generated at runtime
- Different for each environment
- Can be huge in production
- Should be monitored separately

---

### 11. Testing

```
.pytest_cache/         # pytest cache
.coverage              # Code coverage data
htmlcov/               # HTML coverage reports
.tox/                  # tox test environments
.hypothesis/           # Hypothesis test data
*.cover                # Coverage files
```

**Why ignore?**
- Generated during testing
- Different across machines
- Can be regenerated anytime

---

### 12. Git-Aggregator (Generated)

```
/addons/oca/           # Git-aggregated repos
!/addons/oca/.gitkeep  # Keep marker only
```

**Why ignore?**
- `./addons/oca/` is created by git-aggregator from `repos.yml`
- It's downloaded/merged at runtime
- Should be regenerated on each setup
- `.gitkeep` ensures the directory exists in Git

---

## Common Patterns Explained

### Pattern: `directory/`
```
.vscode/
```
Ignores entire directory and its contents.

### Pattern: `*.extension`
```
*.pyc
```
Ignores all files with that extension.

### Pattern: `!file` (negation)
```
!/addons/oca-addons/.gitkeep
```
**Exception:** Keep this file even though parent is ignored.

---

## What Should Be in Git?

✅ **DO commit:**
- Source code files (*.py, *.xml, etc.)
- Configuration templates (`.env.example`)
- Documentation (*.md)
- `.gitkeep` files (for empty directories)
- Scripts (shell, python)
- Manifest files (`__manifest__.py`)
- Views and data files

❌ **DON'T commit:**
- Secrets (passwords, keys, tokens)
- Generated files (*.pyc, __pycache__)
- IDE settings (.vscode/, .idea/)
- Data files (database, attachments)
- Logs
- Node modules or other dependencies

---

## For Each Role

### Developer

Check before committing:
```bash
git status
# Should only show your source code changes
# Should NOT show .env, docker volumes, etc.
```

If you accidentally staged something:
```bash
git reset filename  # Unstage
rm filename         # Delete if needed
```

### Tech Lead / Maintainer

Review `.gitignore` when:
- Adding new tools (add their artifacts to ignore)
- New IDEs in team (add their settings)
- New testing framework (add its output)

Update `.gitignore` if:
- Team changes OS (update OS section)
- Team adopts new package manager (update that section)

### DevOps

Key things to monitor:
- `.env` files are NEVER in Git (check before deployment)
- `addons/oca/` is regenerated at deployment (not in Git)
- Backups are stored separately (not in Git)

---

## Testing Your .gitignore

### Check what's ignored
```bash
# See files that would be ignored
git check-ignore -v .env
git check-ignore -v addons/oca/helpdesk

# Expected output:
# .env → should be ignored
# addons/oca/helpdesk → should be ignored
```

### Check what would be committed
```bash
# See files that would be committed
git status
git diff --cached  # Staged files

# Should only see your actual code changes
```

### Before pushing
```bash
# Make sure nothing secret is staged
git diff HEAD --name-only

# Check for sensitive patterns
git log -p -S "password" --all
git log -p -S ".env" --all
```

---

## Common Mistakes

### ❌ Committing Secrets
**Problem:** Someone commits `.env` with passwords
**Solution:**
```bash
# Remove from history (careful!)
git filter-branch --tree-filter 'rm -f .env' -- --all

# Better: Use git-secrets hook to prevent
```

### ❌ Forgetting .gitkeep
**Problem:** Empty directories disappear from Git
**Solution:**
```bash
# Add .gitkeep to empty dirs you want to track
touch addons/custom/.gitkeep
git add addons/custom/.gitkeep
```

### ❌ Committing Generated Files
**Problem:** `.pyc`, `__pycache__/` accidentally in Git
**Solution:**
```bash
# Remove from Git (but keep locally)
git rm --cached *.pyc
git rm --cached -r __pycache__/

# They'll stay in .gitignore for future
```

---

## Updating .gitignore

### When you need to ignore something new

```bash
# 1. Add to .gitignore
echo "*.new_extension" >> .gitignore

# 2. Remove from Git (if already there)
git rm --cached myfile.new_extension

# 3. Commit the change
git add .gitignore
git commit -m "chore: ignore *.new_extension files"

# 4. Tell team to update
git pull  # They get the updated .gitignore
```

---

## Reference: Quick Lookup

| Need to ignore... | Pattern | In section... |
|-------------------|---------|---------------|
| Python cache | `__pycache__/` | Python |
| IDE settings | `.vscode/` | IDE & Editor |
| Secrets | `.env` | Environment |
| API keys | `*.key` | Environment |
| Database backup | `*.sql` | Docker Volumes |
| Temporary files | `*.tmp` | Temporary Files |
| OS files | `.DS_Store` | Operating System |
| Build artifacts | `build/` | Python |

---

## Security Checklist

- [ ] `.env` is in .gitignore
- [ ] `*.key` and `*.pem` are in .gitignore
- [ ] `credentials.json` is in .gitignore
- [ ] `.ssh/` is in .gitignore
- [ ] No secrets in commit history: `git log -p | grep -i password`
- [ ] `.gitignore` is tracked in Git (it is)
- [ ] Team reviewed `.gitignore` before first deployment

---

## More Info

- [GitHub's .gitignore templates](https://github.com/github/gitignore)
- [gitignore.io](https://gitignore.io) - Generate gitignore files
- [Comprehensive gitignore guide](https://git-scm.com/docs/gitignore)

---

**Last updated:** October 30, 2025

Questions? Check your `.gitignore` file or ask your tech lead!
